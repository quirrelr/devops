# *Данный файл является решением для [[DevOps1]]* 

## Part 1. Установка ОС

![1-1-1](/_resources/devops/1-1-1.png)


## Part 2. Создание пользователя

1. Создание пользователя происходит через команду *adduser* и выполняется только с использованием root-прав. При этом создается дирректория *home/(имя пользователя)*
2. Добавление в группу выполняется через команду *sudo usermod -aG (группа доступа) (имя пользователя)*. В нашем случае мы добавили пользователя **user1** в группу **adm**, предоставляя доступ к логам в */var/log* без использования *sudo*
#### Содержимое /etc/passwd
*Данный файл хранит информацию о пользователях системы и используется для идентификации пользователей при входе в систему, запуске процессов от имени пользователя и т.д.* 
![1-1-1](/_resources/devops/1-2-1.png)
## Part 3. Настройка сети ОС

#### Установил новое имя хоста и убедился в выполнении с помощью команды
![1-1-1](/_resources/devops/1-3-1.png)
#### Установил новый часовой пояс и убедился в выполнении с помощью команды
![1-1-1](/_resources/devops/1-3-2.png)
#### Названия сетевых интерфейсов с помощью команды ip a
![1-1-1](/_resources/devops/1-3-3.png)
*lo (от loopback) - это специальный виртуальный сетевой интерфейс, через который компьютер может обращаться к самому себе.*
**Для чего используется интерфейс lo:**
1. Взаимодействие между локальными сервисами
2. Тестирование сетевых приложений, не выходя за пределы системы
3. Обход внешней сети при свяхи между программами на одной машине
4. Безопасность и изоляция
#### IP-адрес через DHCP
Используя команду *sudo dhclient -v* получил сведения об ip-адресе устройства от DHCP-сервера
![1-1-1](/_resources/devops/1-3-5.png)
***DHCP (Dynamic Host Configuration Protocol)** - это протокол, который автоматически выдает IP-адреса и другие сетевые настройки компьютерам в сети*


#### Вывод внутреннего и внешнего IP-адресов шлюза

![1-1-1](/_resources/devops/1-3-6.png)

Данная команда показывает текущую таблицу маршрутизации и выделяет из нее основной маршрут по умолчанию, который используется для выхода в интернет.

Внешний ip-адрес шлюза

![1-1-1](/_resources/devops/1-3-7.png)

С помощью команды curl обратился к сайту ifconfig.me

#### Задача статичных настроек ip, gw, dns
Я изменил файл */etc/netplan/00-installer-config.yaml*, который содержит настройки сетевого интерфейса, которые были выбраны или заданы по умолчанию.

![1-1-1](/_resources/devops/1-3-8.png)

После этого обязательно вводим команду *sudo netplan apply* для применения новой конфигурации

Выведем информацию о сетевых интерфейсах через *ip a* и увидим наш ip-адрес:

![](/_resources/devops/1-3-9.png)

А вот внутренний ip-адрес шлюза:

![](/_resources/devops/1-3-10.png)

Результат выполнения команды *resolvectl status*:

![](/_resources/devops/1-3-11.png)

*При пинговании у меня выходили ошибки, и даже шлюз не пинговался. Я долго не мог понять причину и искал ошибку в сетевых настройках. Ошибка оказалась немного иного рода - нужно было покопаться в настройках виртуальной машины и настроить мостовое соединение.*

Также я поменял айпи шлюза на реальный - 192.168.0.1

Теперь пингуем DNS сервера:

![](/_resources/devops/1-3-12.png)

Все получилось! Ура!

## Part 4. Обновление ОС
#### Обновление системных пакетов

![](/_resources/devops/1-3-13.png)

## Part 5. Использование команды sudo
#### Выдача прав пользователю на использование sudo
С помощью команды *sudo usermod -aG sudo user1* добавил пользователя в группу **sudo**

Группа доступа sudo позволяет пользователям использовать команды от имени root. При этом команды, выполненные через sudo, записываются в лог (*/var/log/auth.log*)
#### Смена hostname от имени другого пользователя

![](/_resources/devops/1-3-14.png)

## Part 6. Установка и настройка службы времени
#### Настройка службы автоматической синхронизации времени
Часовой пояс:

![](/_resources/devops/1-3-15.png)

Так как служба автоматической синхронизации времени у меня уже работала, я ее отключил с помощью команды *sudo timedatectl set-ntp false*
Ну и потом снова включил :

![](/_resources/devops/1-3-16.png)

## Part 7. Установка и использование текстовых редакторов
#### Скриншоты из текстовых редакторов
**VIM**

![](/_resources/devops/1-3-17.png)

Для выхода и сохранения использовал комбинацию *:wq*
Для поиска: /(выражение)
Для замены: :s/(заменяемое)/(замена)

**NANO**

![](/_resources/devops/1-3-18.png)
Для выхода и сохранения: Ctrl + X
Для поиска: Ctrl + W
Для замены: Ctrl + R

**MCEDIT**

![](/_resources/devops/1-3-19.png)

Для выхода и сохранения: F2, а затем F10
Для поиска: F7
Для замены F4

## Part 8. Установка и базовая настройка сервиса SSHD
#### Установка службы SSHd
Произвел с помощью команды *sudo apt install openssh-server*
#### Включение автостарта
Команда *sudo systemctl enable ssh*
#### Перенастройка на порт 2022
Изменил файл /etc/ssh/sshd_config

![](/_resources/devops/1-3-20.png)

#### Наличие процесса через команду ps

![](/_resources/devops/1-3-21.png)

**ps (process status)** - команда для просмотра процессов
*а* - показать процессы всех пользоваетелей
*x* - включить процессы, не привязанные к терминалу
#### Вывод команды netstat -tan

![](/_resources/devops/1-3-22.png)

Команда *netstat* используется для показа сетевой активности, такой как:
-- Активные соединения
-- Слушающие порты
-- Таблица маршрутизации
-- Статистика интерфейсов и протоколов

**Значение ключей:**
*-t* Показывает только [[Понятия и определения#^b7b694|TCP-соединения]]
*-a* Показывает все соединения и порты (активные и прослушиваемые)
*-n* Показывает IP-адреса и порты в числовом виде (не переводит в имена)

**Команда выводит несколько столбцов и ниже пояснения для них:**
*Proto* - Протокол: tcp или tcp6 (для IPv6)
*Recv-Q* - Очередь принятых, но еще необработанных байт
*Send-Q* - Очередь отправленных, но еще неподтвержденных байт
*Local Address* - Локальный IP и порт (на стороне этой машины)
Foreign Address - Удаленный IP и порт (кому подключена или от кого идет соединение)
State - Состояние TCP-соединения

**Адрес 0.0.0.0** в выводе команды означает "Все доступные IP-адреса этого устройства", т.е. интерфейс или служба слушает соединения на всех сетевых интерфейсах, независимо от IP.

## Part 9. Установка и использование утилит top и htop 
#### top

![](/_resources/devops/1-3-23.png)

 uptime - 1:46
 Количество авторизованных пользователей - 1
 средняя загрузка системы - 0
 Общее количество процессов - 95
 Загрузка CPU - 0
 Загрузка памяти - 146.8 Мб
 pid процесса, занимающего больше всего памяти - 662
 pid процесса, занимающего больше всего процессорного времени - 1401
#### htop
по pid

![](/_resources/devops/d1-p9-1.png)

по CPU%

![](/_resources/devops/d1-p9-2.png)

по MEM%

![](/_resources/devops/d1-p9-3.png)

по TIME+

![](/_resources/devops/d1-p9-4.png)

отфильтрованный для процесса sshd

![](/_resources/devops/d1-p9-5.png)

поиск syslog

![](/_resources/devops/d1-p9-6.png)

Hostname, uptime и clock

![](/_resources/devops/d1-p9-7.png)

## Part 10. Использование утилиты fdisk
## fdisk -l

![](/_resources/devops/d1-p10-1.png)

Название жесткого диска: sda
Размер: 10737418240 байт
Кол-во секторов: 20971520
Размер swap: 0 (его нет)
## Part 11. Использование утилиты df
#### df

![](/_resources/devops/d1-p11-1.png)

Размер раздела: 8408452 Кб
Размер занятого пространства: 4390428 Кб
Размер свободного пространства: 3569308 Кб
Процент использования: 56%
#### df -Th

![](/_resources/devops/d1-p11-2.png)

Размер раздела: 8.1 Гб
Размер занятого пространства: 4.2 Гб
Размер свободного пространства: 3.5 Гб
Процент использования: 56%
Тип файловой системы: ext4
## Part 12. Использование утилиты du
#### Размер папок /home, /var, /var/log в байтах

![](/_resources/devops/d1-p12-1.png)

#### Размер папок в человекочитаемом виде

![](/_resources/devops/d1-p12-2.png)

#### Размер содержимого /var/log

![](/_resources/devops/d1-p12-3.png)

## Part 13. Установка и использование утилиты ncdu
#### /home

![](/_resources/devops/d1-p13-1.png)

#### /var

![](/_resources/devops/d1-p13-2.png)

#### /var/log/

![](/_resources/devops/d1-p13-3.png)

## Part 14. Работа с системными журналами
#### Отчет об авторизации

![](/_resources/devops/d1-p14-1.png)

Время успешной авторизации: 14:34:04
Имя пользователя: quirrelr
Метод входа в систему: LOGIN
#### Рестарт SSHd и сообщения в логах

![](/_resources/devops/d1-p14-2.png)

## Part 15. Использование планировщика заданий CRON
#### Вывод из системного журнала строк о выполнении uptime

![](/_resources/devops/d1-p15-1.png)

#### Список текущих задач в CRON

![](/_resources/devops/d1-p15-2.png)

#### Удаление заданий

![](/_resources/devops/d1-p15-3.png)